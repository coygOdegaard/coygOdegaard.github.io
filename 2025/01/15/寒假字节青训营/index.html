<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>寒假字节青训营 | coygOdegaard</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="SQL Optimizer解析optimizer是优化器。 大数据体系与SQL处理流程  Parser  Analyser和Logical Plan  算子只是操作说明，没有具体的实现。 left-deep tree：每个JOIN的右边必须是scan（就是读取一张表）。 查询优化  Physical Plan和Executor  Plan Fragment只包含了完整执行计划的一部分，完整执行计划">
<meta property="og:type" content="article">
<meta property="og:title" content="寒假字节青训营">
<meta property="og:url" content="http://example.com/2025/01/15/%E5%AF%92%E5%81%87%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/index.html">
<meta property="og:site_name" content="coygOdegaard">
<meta property="og:description" content="SQL Optimizer解析optimizer是优化器。 大数据体系与SQL处理流程  Parser  Analyser和Logical Plan  算子只是操作说明，没有具体的实现。 left-deep tree：每个JOIN的右边必须是scan（就是读取一张表）。 查询优化  Physical Plan和Executor  Plan Fragment只包含了完整执行计划的一部分，完整执行计划">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115102028282.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115102259290.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115102412176.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115103016868.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115103508958.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115104805690.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115105032425.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115142531697.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115142846898.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115143329729.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115143541595.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115143847372.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115144217154.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115144753427.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115144939094.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115145612827.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115145922720.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115150402853.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115150659676.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115152458806.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115152846180.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115153147035.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115154046701.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116154146733.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116154325220.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116154630915.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116155036161.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116155710352.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116161504221.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116162054670.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116162959218.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116164120781.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116165338291.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116165724154.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116170242230.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116171041384.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116171109384.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116171229762.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116171417857.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116173517314.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116173716334.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116173939863.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116174147834.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116174340282.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116174817831.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116192925311.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116193111934.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116193254190.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116193747409.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116201644458.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116201701867.png">
<meta property="og:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250116201753632-1737029874253-1.png">
<meta property="article:published_time" content="2025-01-15T02:07:18.000Z">
<meta property="article:modified_time" content="2025-01-16T12:26:07.471Z">
<meta property="article:author" content="Odegaard">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/source/imgs/$%7Bfiilname%7D/image-20250115102028282.png">
  
    <link rel="alternative" href="/atom.xml" title="coygOdegaard" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
				<img lazy-src="/img/三笠.jpg" class="js-avatar">
			
		</a>

		<hgroup>
			<h1 class="header-author"><a href="/">Odegaard</a></h1>
		</hgroup>

		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">Home</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
						</ul>
					</nav>
					<nav class="half-header-menu">
						<a class="hide">Home</a>
						<a>Tags</a>
						<a>Links</a>
						<a>About</a>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
						<!-- music -->
						
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size: 10px;">大数据</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a> <a href="/tags/%E8%AF%AD%E8%A8%80/" style="font-size: 15px;">语言</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/">github</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">I&#39;m a gunner.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/三笠.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-寒假字节青训营" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2025/01/15/%E5%AF%92%E5%81%87%E5%AD%97%E8%8A%82%E9%9D%92%E8%AE%AD%E8%90%A5/" class="article-date">
  	<time datetime="2025-01-15T02:07:18.000Z" itemprop="datePublished">2025-01-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      寒假字节青训营
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SQL-Optimizer解析"><a href="#SQL-Optimizer解析" class="headerlink" title="SQL Optimizer解析"></a>SQL Optimizer解析</h1><p>optimizer是优化器。</p>
<h2 id="大数据体系与SQL处理流程"><a href="#大数据体系与SQL处理流程" class="headerlink" title="大数据体系与SQL处理流程"></a>大数据体系与SQL处理流程</h2><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115102028282.png" alt="image-20250115102028282"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115102259290.png" alt="image-20250115102259290"></p>
<p><strong>Parser</strong></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115102412176.png" alt="image-20250115102412176"></p>
<p><strong>Analyser和Logical Plan</strong></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115103016868.png" alt="image-20250115103016868"></p>
<p>算子只是操作说明，没有具体的实现。</p>
<p>left-deep tree：每个JOIN的右边必须是scan（就是读取一张表）。</p>
<p><strong>查询优化</strong></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115103508958.png" alt="image-20250115103508958"></p>
<p><strong>Physical Plan和Executor</strong></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115104805690.png" alt="image-20250115104805690"></p>
<p>Plan Fragment只包含了完整执行计划的一部分，完整执行计划拆分成多个Plan Fragment。</p>
<p>拆分执行计划后，每个节点之间靠Shuffle算子来连接。（后面会介绍）</p>
<p>每个节点会增加一个Executor，似乎是提升运行速度。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115105032425.png" alt="image-20250115105032425"></p>
<h2 id="常见优化查询"><a href="#常见优化查询" class="headerlink" title="常见优化查询"></a>常见优化查询</h2><p><strong>分类</strong></p>
<p>第一种：按照遍历树的顺序</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115142531697.png" alt="image-20250115142531697"></p>
<p>第二种：根据优化的方法</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115142846898.png" alt="image-20250115142846898"></p>
<p>RBO根据规则优化，重写查询。</p>
<h3 id="RBO"><a href="#RBO" class="headerlink" title="RBO"></a>RBO</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115143329729.png" alt="image-20250115143329729"></p>
<p>R是一个表，p1,p2,p3……pn是条件</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115143541595.png" alt="image-20250115143541595"></p>
<p><strong>优化规则</strong></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115143847372.png" alt="image-20250115143847372"></p>
<p>列裁剪（尽可能减少数据）：从上往下扫描，找出这个执行计划中需要的列（感觉就是元素），一直到最后的SCAN，就是只读取需要的列，其他的不要，减少IO交换。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115144217154.png" alt="image-20250115144217154"></p>
<p>WHERE里面的那些表达式就是谓词。</p>
<p>将谓词尽可能地往前推和往下推，尽早地过滤掉一些不必要的数据。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115144753427.png" alt="image-20250115144753427"></p>
<p>利用一些表达式的等价关系和过滤条件，可以推导出新的过滤条件。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115144939094.png" alt="image-20250115144939094"></p>
<p>16分钟，没听懂。</p>
<p>在运行的时候，从右边获取新的条件运用到左边进行读取。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115145612827.png" alt="image-20250115145612827"></p>
<h3 id="CBO"><a href="#CBO" class="headerlink" title="CBO"></a>CBO</h3><p>概念：</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115145922720.png" alt="image-20250115145922720"></p>
<p>统计信息：</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115150402853.png" alt="image-20250115150402853"></p>
<p>原始表统计信息可以SCAN出来，中间算子的统计信息需要进行推导，所以叫作推导统计信息。</p>
<p>统计信息的收集方式：</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115150659676.png" alt="image-20250115150659676"></p>
<p>第一种在执行时如果遇到数据更新啥的，会导致速度较慢；第二种因为是手动执行的，所以收集到的数据可能会比较旧，因为需要手动执行后数据才会更新。</p>
<p>统计信息推导原则：</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115152458806.png" alt="image-20250115152458806"></p>
<p>Filter Selectivity，选择率</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115152846180.png" alt="image-20250115152846180"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115153147035.png" alt="image-20250115153147035"></p>
<p>动态规划方法就是将寻找整体最优解问题分成寻找局部最优解问题，然后不断地通过局部的最优解得到全局的最优解。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250115154046701.png" alt="image-20250115154046701"></p>
<h1 id="流-批-OLAP一体的Flink引擎介绍"><a href="#流-批-OLAP一体的Flink引擎介绍" class="headerlink" title="流&#x2F;批&#x2F;OLAP一体的Flink引擎介绍"></a>流&#x2F;批&#x2F;OLAP一体的Flink引擎介绍</h1><h2 id="Apache-Flink概述"><a href="#Apache-Flink概述" class="headerlink" title="Apache Flink概述"></a>Apache Flink概述</h2><h3 id="诞生背景"><a href="#诞生背景" class="headerlink" title="诞生背景"></a>诞生背景</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116154146733.png" alt="image-20250116154146733"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116154325220.png" alt="image-20250116154325220"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116154630915.png" alt="image-20250116154630915"></p>
<h3 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h3><p>Flink是流式计算的一个框架。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116155036161.png" alt="image-20250116155036161"></p>
<h3 id="开源生态"><a href="#开源生态" class="headerlink" title="开源生态"></a>开源生态</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116155710352.png" alt="image-20250116155710352"></p>
<h2 id="Flink整体架构"><a href="#Flink整体架构" class="headerlink" title="Flink整体架构"></a>Flink整体架构</h2><h3 id="Flink分层架构"><a href="#Flink分层架构" class="headerlink" title="Flink分层架构"></a>Flink分层架构</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116161504221.png" alt="image-20250116161504221"></p>
<p>不管是SQL描述还是DataStream还是pfFlink描述，在执行引擎层都会转化为一个统一的抽象的DAG图，它是一个逻辑的表达方式。</p>
<p>状态存储层：State Backend；然后上面的三层都是执行引擎层。</p>
<h3 id="Flink总体架构"><a href="#Flink总体架构" class="headerlink" title="Flink总体架构"></a>Flink总体架构</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116162054670.png" alt="image-20250116162054670"></p>
<p>DataFlowGraph就是DAG的一个图。</p>
<p>代码全部都是写在Program code那边，不管是java还是python 什么的，然后经过一些处理转化为DataFlow的一个graph，就是DAG的一张图。Client端会将用户数据处理逻辑转化为DAG的一张图，然后Client端会将这张图提交给JM。JM会将它简化为一个具体的物理执行图，并且JM根据物理执行图对应的任务将对应的Task调用到TM中。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116162959218.png" alt="image-20250116162959218"></p>
<p>JobMaster是申请资源(slot)的。</p>
<p>Client端提交作业，Dispatcher拉几个JobMaster，JobMaster向ResourceManager申请资源，上图中两个TM向ResourceManager申请注册，注册完毕后代表此时资源中有两个TM可以调用，那JM如果申请调用两个TM的话就可以调用了。</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116164120781.png" alt="image-20250116164120781"></p>
<p>第一步是弄一个环境变量，要从哪里读入数据，addSource里面填的是地址，要从哪里读。</p>
<p>map就是一个一对一的解析处理，这边处理的是一行数据。一行语句中是有空格的，而这个parse语句就可以根据这个空格把这条语句拆开，这边就是拆成了一个Event的格式。</p>
<p>keyBy是将想同的数据弄到一块，将数据分发到Task上，apply是对数据做什么处理。</p>
<p>最后是将数据写到某个地方。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116165338291.png" alt="image-20250116165338291"></p>
<p>为什么map到keyBy会有那么多线，因为map处理后的数据会在keyBy中处理根据它处理的哈希值进行分配，所以map处理的数据可能会到keyBy1也有可能会到keyBy2。</p>
<p>这是逻辑执行图-&gt;可以执行并发的一个执行图。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116165724154.png" alt="image-20250116165724154"></p>
<p>source也叫operator或者task。</p>
<p>可以将source和map嵌在一起执行，因为不用经过keyBy分配，所以source读完一条数据后紧接着就可以调用map进行处理，可以在同一个线程中进行。什么算子可以嵌在一起是有判断条件的，可以去官网查看。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116170242230.png" alt="image-20250116170242230"></p>
<p>每个TM里面可以有多少个slot是用户自己定义的，每个slot在TM里面都是有一个单独的线程的。</p>
<h3 id="Flink如何做到流批一体化"><a href="#Flink如何做到流批一体化" class="headerlink" title="Flink如何做到流批一体化"></a>Flink如何做到流批一体化</h3><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116171041384.png" alt="image-20250116171041384"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116171109384.png" alt="image-20250116171109384"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116171229762.png" alt="image-20250116171229762"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116171417857.png" alt="image-20250116171417857"></p>
<h4 id="流批一体的Scheduler层"><a href="#流批一体的Scheduler层" class="headerlink" title="流批一体的Scheduler层"></a>流批一体的Scheduler层</h4><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116173517314.png" alt="image-20250116173517314"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116173716334.png" alt="image-20250116173716334"></p>
<p>LAZY等上游资源处理完之后可以用上游处理完的资源去处理下游。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116173939863.png" alt="image-20250116173939863"></p>
<p>12个task一起调度，不是16个。</p>
<p>A有两个并发，B有两个，C有四个，D有四个，B的要平均传输到两个C中，C要传输到4个D中。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116174147834.png" alt="image-20250116174147834"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116174340282.png" alt="image-20250116174340282"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116174817831.png" alt="image-20250116174817831"></p>
<p>BLOCKING：A产生的数据不会立马传给B，数据不是实时传输的，中间需要先落盘，就是存到磁盘中，这样子在A1执行完后B1可以从磁盘中读取数据，这样子A1可以先执行，执行完后释放资源，然后执行B1。</p>
<p>PLIPELINED：A产生的数据直接传给B，中间不落盘，直接走到内存，就是A1的数据可能先存到内存中，然后发给B1后内存就释放掉了。最后还是需要12个task的资源，这个作业才能整体运行起来。</p>
<h4 id="流批一体的Shuffle-Service层"><a href="#流批一体的Shuffle-Service层" class="headerlink" title="流批一体的Shuffle Service层"></a>流批一体的Shuffle Service层</h4><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116192925311.png" alt="image-20250116192925311"></p>
<p>涉及到上下游的数据交换就是一个shuffle。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116193111934.png" alt="image-20250116193111934"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116193254190.png" alt="image-20250116193254190"></p>
<p>流作业中如果task销毁了，那么shuffle也没了，而批的不会。</p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116193747409.png" alt="image-20250116193747409"></p>
<h2 id="Flink架构优化"><a href="#Flink架构优化" class="headerlink" title="Flink架构优化"></a>Flink架构优化</h2><h3 id="流-批-OLAP业务场景概述"><a href="#流-批-OLAP业务场景概述" class="headerlink" title="流&#x2F;批&#x2F;OLAP业务场景概述"></a>流&#x2F;批&#x2F;OLAP业务场景概述</h3><p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116201644458.png" alt="image-20250116201644458"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116201701867.png" alt="image-20250116201701867"></p>
<p><img src="/../source/imgs/$%7Bfiilname%7D/image-20250116201753632-1737029874253-1.png" alt="image-20250116201753632"></p>
<h3 id="Flink如何支持OLAP场景"><a href="#Flink如何支持OLAP场景" class="headerlink" title="Flink如何支持OLAP场景"></a>Flink如何支持OLAP场景</h3><p>需要有一定基础，建议之后再看。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/01/21/%E7%AE%97%E6%B3%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          算法
        
      </div>
    </a>
  
  
    <a href="/2025/01/14/%E9%9D%92%E8%AE%AD%E8%90%A5/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"></div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>






</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2025 Odegaard
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/preccrep/hexo-theme-jelly" target="_blank">Jelly</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>